<!DOCTYPE html>
<html>
<head>
<title>Chat</title>
</head>
  <style>
    fieldset{
  width: 260px;
}
#textfield{
  width: 200px;
  height: 50px;
}

  </style>
<body>
<!-- Start your code here -->

  <form action=''>
    <fieldset>
      <legend>Chat</legend>
      <label for="count_users">Users online</label>
      <output id="count_users"></output>
      <p></p>
      
      <label for="username">Username</label>
      <output id="username"></output>
     
      <p></p>
    
      <input id="textfield"/>
      
      <input type="button" value="Send" onClick="sendMessage()"/>
      
    </fieldset>
  </form>
  
  <form action='/changeName' method="get">
   <input type="submit" value="Изменить имя" />
   </form>
 
  <ul id="messages"></ul>

</body>
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io();

  function sendMessage(){
    //Отправляю сообщение, и имя отправившего
    socket.emit('chat message', document.getElementById('textfield').value, document.cookie.split('=')[1]);
    document.getElementById('textfield').value = "";
  }

  socket.on('chat message', function(message){

    console.log(message)

    let messageLine = document.createElement("li");

    let mess = document.createTextNode(message);

    messageLine.appendChild(mess);

    document.getElementById('messages').appendChild(messageLine);
  });

  socket.on('users online', function(usersOnline){

    document.getElementById("count_users").value = usersOnline;
  });

  document.getElementById("username").value = document.cookie.split('=')[1];


</script>
</html>